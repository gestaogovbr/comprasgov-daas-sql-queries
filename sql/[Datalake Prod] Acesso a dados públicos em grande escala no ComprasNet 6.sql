SELECT
	l.lanCod AS tbl_Lances_lanCod,
	l.ipgCod AS tbl_Lances_ipgCod,
	l.cliente_id AS tbl_Lances_cliente_id,
	l.lanData AS tbl_Lances_lanData,
	l.lanValor AS tbl_Lances_lanValor,
	l.lanStatus AS tbl_Lances_lanStatus,
	l.lanDataExclui AS tbl_Lances_lanDataExclui,
	l.lanIndExclPreg AS tbl_Lances_lanIndExclPreg,
	l.lanIndExclLances AS tbl_Lances_lanIndExclLances,
	l.lanClassif AS tbl_Lances_lanClassif,
	l.lanIndConvocacao AS tbl_Lances_lanIndConvocacao,
	l.lanIndConvocacao7174 AS tbl_Lances_lanIndConvocacao7174,
	l.dataInclusao AS tbl_Lances_dataInclusao,
	l.dataAlteracao AS tbl_Lances_dataAlteracao,
	pri.ippCod AS tbl_PropostaItem_ippCod,
	pri.prpCod AS tbl_PropostaItem_prpCod,
	pri.ipgCod AS tbl_PropostaItem_ipgCod,
	pri.ippValor AS tbl_PropostaItem_ippValor,
	pri.sppCod AS tbl_PropostaItem_sppCod,
	pri.ippMarcaFornec AS tbl_PropostaItem_ippMarcaFornec,
	pri.ippDescrFornec AS tbl_PropostaItem_ippDescrFornec,
	pri.ippData AS tbl_PropostaItem_ippData,
	pri.ippQtd AS tbl_PropostaItem_ippQtd,
	pri.ipgMotivoDesclassif AS tbl_PropostaItem_ipgMotivoDesclassif,
	pri.prpSequencial AS tbl_PropostaItem_prpSequencial,
	pri.ippUFFaturaNF AS tbl_PropostaItem_ippUFFaturaNF,
	pri.ippFatorEqualizICMS AS tbl_PropostaItem_ippFatorEqualizICMS,
	pri.ippLanceMin AS tbl_PropostaItem_ippLanceMin,
	pri.ippLanceMinClassif AS tbl_PropostaItem_ippLanceMinClassif,
	pri.ippValorClassif AS tbl_PropostaItem_ippValorClassif,
	pri.ippIndAceito AS tbl_PropostaItem_ippIndAceito,
	pri.ippIndHabilitado AS tbl_PropostaItem_ippIndHabilitado,
	pri.ippIndAdjudicado AS tbl_PropostaItem_ippIndAdjudicado,
	pri.ippValNegAceit AS tbl_PropostaItem_ippValNegAceit,
	pri.ippValNegAdj AS tbl_PropostaItem_ippValNegAdj,
	pri.ippObsAceitacao AS tbl_PropostaItem_ippObsAceitacao,
	pri.ippObsAdjudicacao AS tbl_PropostaItem_ippObsAdjudicacao,
	pri.ippDataUltLance AS tbl_PropostaItem_ippDataUltLance,
	pri.ippFabricante AS tbl_PropostaItem_ippFabricante,
	pri.ippOrdemConvocacao AS tbl_PropostaItem_ippOrdemConvocacao,
	pri.ippDataIniConvocacao AS tbl_PropostaItem_ippDataIniConvocacao,
	pri.ippDataFimConvocacao AS tbl_PropostaItem_ippDataFimConvocacao,
	pri.ippStatusConvocacao AS tbl_PropostaItem_ippStatusConvocacao,
	pri.ippIndPropOriginal AS tbl_PropostaItem_ippIndPropOriginal,
	pri.ippIndCadSubcontratada AS tbl_PropostaItem_ippIndCadSubcontratada,
	pri.ippJustificativaSubPreg AS tbl_PropostaItem_ippJustificativaSubPreg,
	pri.ippJustificativaSubFornec AS tbl_PropostaItem_ippJustificativaSubFornec,
	pri.ippIndAnexo AS tbl_PropostaItem_ippIndAnexo,
	pri.ippOrdemConvocacao7174 AS tbl_PropostaItem_ippOrdemConvocacao7174,
	pri.ippDataIniConvocacao7174 AS tbl_PropostaItem_ippDataIniConvocacao7174,
	pri.ippDataFimConvocacao7174 AS tbl_PropostaItem_ippDataFimConvocacao7174,
	pri.ippStatusConvocacao7174 AS tbl_PropostaItem_ippStatusConvocacao7174,
	pri.ippMens5Min7174 AS tbl_PropostaItem_ippMens5Min7174,
	pri.ippIndTP AS tbl_PropostaItem_ippIndTP,
	pri.ippIndPPB AS tbl_PropostaItem_ippIndPPB,
	pri.contadorDePunicoes AS tbl_PropostaItem_contadorDePunicoes,
	pri.ippDeclaracaoProdNacional AS tbl_PropostaItem_ippDeclaracaoProdNacional,
	pri.ippCodPaisOrigem AS tbl_PropostaItem_ippCodPaisOrigem,
	pri.ippIndPossuiPessoasEmComum AS tbl_PropostaItem_ippIndPossuiPessoasEmComum,
	pri.ippCadReservaStatus AS tbl_PropostaItem_ippCadReservaStatus,
	pri.ippCadReservaDataAceite AS tbl_PropostaItem_ippCadReservaDataAceite,
	pri.ippModeloVersao AS tbl_PropostaItem_ippModeloVersao,
	pri.dataInclusao AS tbl_PropostaItem_dataInclusao,
	pri.dataAlteracao AS tbl_PropostaItem_dataAlteracao,
	pri.convocadoNaDisputaFechada AS tbl_PropostaItem_convocadoNaDisputaFechada,
	pri.ippLanceMinFaseFechada AS tbl_PropostaItem_ippLanceMinFaseFechada,
	pri.ippLanceMinClassifFaseFechada AS tbl_PropostaItem_ippLanceMinClassifFaseFechada,
	pri.ippDataUltLanceFaseFechada AS tbl_PropostaItem_ippDataUltLanceFaseFechada,
	pri.dataFimConvocacaoDisputaFechada AS tbl_PropostaItem_dataFimConvocacaoDisputaFechada,
	pri.ordemSorteioEletronico AS tbl_PropostaItem_ordemSorteioEletronico,
	pri.versaoSalaDisputa AS tbl_PropostaItem_versaoSalaDisputa,
	pr.prpCod AS tbl_Proposta_prpCod,
	pr.prgCod AS tbl_Proposta_prgCod,
	pr.Cliente_ID AS tbl_Proposta_Cliente_ID,
	pr.prpData AS tbl_Proposta_prpData,
	pr.prpCNPJ AS tbl_Proposta_prpCNPJ,
	pr.prpRazaoSocial AS tbl_Proposta_prpRazaoSocial,
--	pr.prpNomeAnexo AS tbl_Proposta_prpNomeAnexo,
--	pr.prpNomeAnexoRetif AS tbl_Proposta_prpNomeAnexoRetif,
--	pr.prpCaminhoAnexoRetif AS tbl_Proposta_prpCaminhoAnexoRetif,
	pr.prpDataRetif AS tbl_Proposta_prpDataRetif,
	pr.prpPorteEmpresa AS tbl_Proposta_prpPorteEmpresa,
	pr.prpIndParticiparConvocacao AS tbl_Proposta_prpIndParticiparConvocacao,
	pr.prpDataParticiparConvocacao AS tbl_Proposta_prpDataParticiparConvocacao,
	pr.prpDeclaracaoInfantil AS tbl_Proposta_prpDeclaracaoInfantil,
	pr.prpDeclaracaoSuperveniente AS tbl_Proposta_prpDeclaracaoSuperveniente,
	pr.prpDataDeclaracao AS tbl_Proposta_prpDataDeclaracao,
	pr.prpIndConvocarDeclaracao AS tbl_Proposta_prpIndConvocarDeclaracao,
	pr.prpDeclaracaoPropIndependente AS tbl_Proposta_prpDeclaracaoPropIndependente,
	pr.prpDecTrabForcado AS tbl_Proposta_prpDecTrabForcado,
	pr.prpUnico AS tbl_Proposta_prpUnico,
	pr.dataInclusao AS tbl_Proposta_dataInclusao,
	pr.dataAlteracao AS tbl_Proposta_dataAlteracao,
	pr.prpDecAcessibilidade AS tbl_Proposta_prpDecAcessibilidade,
	pr.prpDeclaracaoCotaAprendizagem AS tbl_Proposta_prpDeclaracaoCotaAprendizagem,
--	pr.cliente_id_original AS tbl_Proposta_cliente_id_original, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
	pi.ipgCod AS tbl_pregaoitem_ipgCod,
	pi.prgCod AS tbl_pregaoitem_prgCod,
	pi.ipgItem AS tbl_pregaoitem_ipgItem,
	pi.ipgDescricao AS tbl_pregaoitem_ipgDescricao,
	pi.codmat AS tbl_pregaoitem_codmat,
	pi.ipgIdentMat AS tbl_pregaoitem_ipgIdentMat,
	pi.codmun AS tbl_pregaoitem_codmun,
	pi.coduf AS tbl_pregaoitem_coduf,
	pi.ipgQuantidade AS tbl_pregaoitem_ipgQuantidade,
	pi.ipgUnidForn AS tbl_pregaoitem_ipgUnidForn,
	pi.spgCod AS tbl_pregaoitem_spgCod,
	pi.ipgValorRef AS tbl_pregaoitem_ipgValorRef,
	pi.ipgValorMin AS tbl_pregaoitem_ipgValorMin,
	pi.ipgClienteLanceMin AS tbl_pregaoitem_ipgClienteLanceMin,
	pi.ipgCliente_id AS tbl_pregaoitem_ipgCliente_id,
	pi.ipgDataIminenciaEncerramento AS tbl_pregaoitem_ipgDataIminenciaEncerramento,
	pi.ipgDataEncerramentoReal AS tbl_pregaoitem_ipgDataEncerramentoReal,
--	pi.ipgJustRecurso AS tbl_pregaoitem_ipgJustRecurso, -- SQL Error: Tipo CLOB
	pi.ipgDataDecisao AS tbl_pregaoitem_ipgDataDecisao,
	pi.ipgCPFDecisao AS tbl_pregaoitem_ipgCPFDecisao,
	pi.ipgDecisaoRecurso AS tbl_pregaoitem_ipgDecisaoRecurso,
	pi.ipgDataDecisaoAut AS tbl_pregaoitem_ipgDataDecisaoAut,
	pi.ipgCPFDecisaoAut AS tbl_pregaoitem_ipgCPFDecisaoAut,
	pi.ipgDecisaoRecursoAut AS tbl_pregaoitem_ipgDecisaoRecursoAut,
--	pi.ipgJustRecursoAut AS tbl_pregaoitem_ipgJustRecursoAut, -- SQL Error: Tipo CLOB
	pi.ipgDecisaoHomologacao AS tbl_pregaoitem_ipgDecisaoHomologacao,
	pi.ipgSeqSessao AS tbl_pregaoitem_ipgSeqSessao,
	pi.ipgNomeItem AS tbl_pregaoitem_ipgNomeItem,
	pi.ipgDataSuspensao AS tbl_pregaoitem_ipgDataSuspensao,
	pi.ipgFormaJulg AS tbl_pregaoitem_ipgFormaJulg,
	pi.ipgValorMinClassif AS tbl_pregaoitem_ipgValorMinClassif,
	pi.ipgMotivoCancAceitAdj AS tbl_pregaoitem_ipgMotivoCancAceitAdj,
	pi.ipgGrupo AS tbl_pregaoitem_ipgGrupo,
	pi.ipgCodGrupo AS tbl_pregaoitem_ipgCodGrupo,
	pi.ipgTipoBeneficio AS tbl_pregaoitem_ipgTipoBeneficio,
	pi.ipgCodItemPrincipal AS tbl_pregaoitem_ipgCodItemPrincipal,
	pi.ipgIndItemPrincipal AS tbl_pregaoitem_ipgIndItemPrincipal,
	pi.ipgDataLimiteRecurso AS tbl_pregaoitem_ipgDataLimiteRecurso,
	pi.ipgDataLimiteContraRazao AS tbl_pregaoitem_ipgDataLimiteContraRazao,
	pi.ipgDataLimiteDecisao AS tbl_pregaoitem_ipgDataLimiteDecisao,
	pi.ipgPercSubcontratacaoMin AS tbl_pregaoitem_ipgPercSubcontratacaoMin,
	pi.ipgPercSubcontratacaoMax AS tbl_pregaoitem_ipgPercSubcontratacaoMax,
	p.prgCod AS tbl_Pregao_prgCod,
	p.coduasg AS tbl_Pregao_coduasg,
	p.numprp AS tbl_Pregao_numprp,
	p.prgObjeto AS tbl_Pregao_prgObjeto,
	p.prgDescricao AS tbl_Pregao_prgDescricao,
	p.prgDataAbertura AS tbl_Pregao_prgDataAbertura,
	p.prgDataInclusao AS tbl_Pregao_prgDataInclusao,
	p.prgPregoeiroCad AS tbl_Pregao_prgPregoeiroCad,
	p.prgPregoeiroExec AS tbl_Pregao_prgPregoeiroExec,
	p.prgBat AS tbl_Pregao_prgBat,
	p.prgTimeBat AS tbl_Pregao_prgTimeBat,
	p.prgTempoLimite AS tbl_Pregao_prgTempoLimite,
	p.prgStatus AS tbl_Pregao_prgStatus,
	p.prgDataAberturaReal AS tbl_Pregao_prgDataAberturaReal,
	p.prgDataHom AS tbl_Pregao_prgDataHom,
	p.prgCPFHom AS tbl_Pregao_prgCPFHom,
	p.prgNomePregoeiro AS tbl_Pregao_prgNomePregoeiro,
	p.prgMembro1 AS tbl_Pregao_prgMembro1,
	p.prgMembro2 AS tbl_Pregao_prgMembro2,
	p.prgMembro3 AS tbl_Pregao_prgMembro3,
	p.prgPortaria AS tbl_Pregao_prgPortaria,
	p.prgDataPortaria AS tbl_Pregao_prgDataPortaria,
	p.prgProcesso AS tbl_Pregao_prgProcesso,
	p.codPregoeiro AS tbl_Pregao_codPregoeiro,
	p.codMembro1 AS tbl_Pregao_codMembro1,
	p.codMembro2 AS tbl_Pregao_codMembro2,
	p.codMembro3 AS tbl_Pregao_codMembro3,
	p.prgDataEntregaProp AS tbl_Pregao_prgDataEntregaProp,
	p.prgDataEncerramento AS tbl_Pregao_prgDataEncerramento,
	p.prgDataAbreIntencaoRecurso AS tbl_Pregao_prgDataAbreIntencaoRecurso,
	p.prgDataFechaIntencaoRecurso AS tbl_Pregao_prgDataFechaIntencaoRecurso,
	p.prgIndSRP AS tbl_Pregao_prgIndSRP,
	p.prgDataJulg AS tbl_Pregao_prgDataJulg,
	p.prgCPFJulg AS tbl_Pregao_prgCPFJulg,
	p.prgNomeHom AS tbl_Pregao_prgNomeHom,
	p.prgClienteIDChat AS tbl_Pregao_prgClienteIDChat,
	p.prgDataLimiteRecurso AS tbl_Pregao_prgDataLimiteRecurso,
	p.prgDataLimiteContraRazao AS tbl_Pregao_prgDataLimiteContraRazao,
	p.prgDataAdjudic AS tbl_Pregao_prgDataAdjudic,
	p.prgCPFAdjudic AS tbl_Pregao_prgCPFAdjudic,
	p.prgDataLimiteDecisao AS tbl_Pregao_prgDataLimiteDecisao,
	p.prgNomeJulg AS tbl_Pregao_prgNomeJulg,
	p.prgNomeAdjudic AS tbl_Pregao_prgNomeAdjudic,
	p.prgDataUltimaVoltaFase AS tbl_Pregao_prgDataUltimaVoltaFase,
	p.prgFaseUltimaVoltaFase AS tbl_Pregao_prgFaseUltimaVoltaFase,
	p.prgDataReaberturaSessao AS tbl_Pregao_prgDataReaberturaSessao,
	p.prgMotivoUltimaVoltaFase AS tbl_Pregao_prgMotivoUltimaVoltaFase,
	p.prgRecursoInter AS tbl_Pregao_prgRecursoInter,
	p.prgOrigemRecurso AS tbl_Pregao_prgOrigemRecurso,
	p.prgPercentualLance AS tbl_Pregao_prgPercentualLance,
	p.prgCodEvento AS tbl_Pregao_prgCodEvento,
	p.prgIndElet AS tbl_Pregao_prgIndElet,
	p.prgIndICMS AS tbl_Pregao_prgIndICMS,
	p.prgCodTipoSuspensao AS tbl_Pregao_prgCodTipoSuspensao,
	p.prgCodAvisoEvento AS tbl_Pregao_prgCodAvisoEvento,
	p.prgDataPublicacaoEvento AS tbl_Pregao_prgDataPublicacaoEvento,
	p.prgCodEventoAnterior AS tbl_Pregao_prgCodEventoAnterior,
	p.tempoMinimoLance AS tbl_Pregao_tempoMinimoLance,
	p.numOcorrenciasLance AS tbl_Pregao_numOcorrenciasLance,
	p.prgDataConsultaPessoasEmComum AS tbl_Pregao_prgDataConsultaPessoasEmComum,
	p.dataInclusao AS tbl_Pregao_dataInclusao,
	p.dataAlteracao AS tbl_Pregao_dataAlteracao,
	p.prgModoDisputa AS tbl_Pregao_prgModoDisputa,
	p.retornoServicoRestAbrirSessaoPublica AS tbl_Pregao_retornoServicoRestAbrirSessaoPublica,
	p.faseSalaDisputa AS tbl_Pregao_faseSalaDisputa,
	p.prgSeqSessao AS tbl_Pregao_prgSeqSessao,
	p.prgIndEmergencial AS tbl_Pregao_prgIndEmergencial,
	u.coduasg AS tb_uasg_coduasg,
	u.nomuasg AS tb_uasg_nomuasg,
	u.titulo01 AS tb_uasg_titulo01,
	u.titulo02 AS tb_uasg_titulo02,
	u.titulo03 AS tb_uasg_titulo03,
	u.titulo04 AS tb_uasg_titulo04,
	u.titulo05 AS tb_uasg_titulo05,
	u.titulo06 AS tb_uasg_titulo06,
	u.titulo07 AS tb_uasg_titulo07,
	u.titulo08 AS tb_uasg_titulo08,
	u.titulo09 AS tb_uasg_titulo09,
	u.titulo10 AS tb_uasg_titulo10,
	u.titulo11 AS tb_uasg_titulo11,
	u.titulo12 AS tb_uasg_titulo12,
	u.uf AS tb_uasg_uf,
	u.CodOrgao AS tb_uasg_CodOrgao,
	u.CodSiorg AS tb_uasg_CodSiorg,
	u.SiglaUasg AS tb_uasg_SiglaUasg,
	u.NomeOrgao AS tb_uasg_NomeOrgao,
	u.CodMunic AS tb_uasg_CodMunic,
	u.Endereco AS tb_uasg_Endereco,
	u.Cep AS tb_uasg_Cep,
	u.DDD AS tb_uasg_DDD,
	u.Telefone1 AS tb_uasg_Telefone1,
	u.Ramal1 AS tb_uasg_Ramal1,
	u.Telefone2 AS tb_uasg_Telefone2,
	u.Ramal2 AS tb_uasg_Ramal2,
	u.Fax AS tb_uasg_Fax,
	u.IndicadorFornec AS tb_uasg_IndicadorFornec,
	u.nomeBrasao AS tb_uasg_nomeBrasao,
	u.bloqueioCertificado AS tb_uasg_bloqueioCertificado,
	u.coduasgPolo AS tb_uasg_coduasgPolo,
--	u.Situacao AS tb_uasg_Situacao, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
--	u.indSISG AS tb_uasg_indSISG, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
--	u.adesaoSIASG AS tb_uasg_adesaoSIASG, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
	o.CodOrgao AS tb_orgao_CodOrgao,
	o.NomeOrgao AS tb_orgao_NomeOrgao,
	o.Logo AS tb_orgao_Logo,
	o.TipoAdm AS tb_orgao_TipoAdm,
	o.Esfera AS tb_orgao_Esfera,
	o.Poder AS tb_orgao_Poder,
	o.CodOrgaoVinculado AS tb_orgao_CodOrgaoVinculado
--	o.cnpj AS tb_orgao_cnpj -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
FROM Stg_Comprasnet.dbo.tbl_Lances l
	JOIN Stg_Comprasnet.dbo.tbl_pregaoitem pi ON pi.ipgCod = l.ipgCod
	JOIN Stg_Comprasnet.dbo.tbl_Pregao p ON p.prgCod = pi.prgCod
	JOIN Stg_Comprasnet.dbo.tbl_PropostaItem pri ON pri.ipgCod = l.ipgCod
	JOIN Stg_Comprasnet.dbo.tbl_Proposta pr ON (pr.prpCod = pri.prpCod AND pr.Cliente_ID = l.cliente_id)
	JOIN Stg_Comprasnet.dbo.tb_uasg u ON p.coduasg = u.coduasg
	LEFT JOIN Stg_Comprasnet.dbo.tb_orgao o ON o.CodOrgao = u.CodOrgao
	LEFT JOIN Stg_Comprasnet.dbo.tb_orgao o2 ON o2.CodOrgao= o.CodOrgaoVinculado
WHERE 1=1
--	AND l.lanData BETWEEN '2010-01-01 00:00:00' AND '2018-10-26 18:00:47' 
--	AND (o2.CodOrgao IN (95430) OR p.coduasg IN (986001))
	AND p.coduasg IN (986001);
UNION
SELECT
	l.lanCod AS tbl_Lances_lanCod,
	l.ipgCod AS tbl_Lances_ipgCod,
	l.cliente_id AS tbl_Lances_cliente_id,
	l.lanData AS tbl_Lances_lanData,
	l.lanValor AS tbl_Lances_lanValor,
	l.lanStatus AS tbl_Lances_lanStatus,
	'' AS tbl_Lances_lanDataExclui,
	'' AS tbl_Lances_lanIndExclPreg,
	'' AS tbl_Lances_lanIndExclLances,
	l.lanClassif AS tbl_Lances_lanClassif,
	l.lanIndConvocacao AS tbl_Lances_lanIndConvocacao,
	l.lanIndConvocacao7174 AS tbl_Lances_lanIndConvocacao7174,
	l.dataInclusao AS tbl_Lances_dataInclusao,
	l.dataAlteracao AS tbl_Lances_dataAlteracao,
	pri.ippCod AS tbl_PropostaItem_ippCod,
	pri.prpCod AS tbl_PropostaItem_prpCod,
	pri.ipgCod AS tbl_PropostaItem_ipgCod,
	pri.ippValor AS tbl_PropostaItem_ippValor,
	pri.sppCod AS tbl_PropostaItem_sppCod,
	pri.ippMarcaFornec AS tbl_PropostaItem_ippMarcaFornec,
	pri.ippDescrFornec AS tbl_PropostaItem_ippDescrFornec,
	pri.ippData AS tbl_PropostaItem_ippData,
	pri.ippQtd AS tbl_PropostaItem_ippQtd,
	pri.ipgMotivoDesclassif AS tbl_PropostaItem_ipgMotivoDesclassif,
	pri.prpSequencial AS tbl_PropostaItem_prpSequencial,
	pri.ippUFFaturaNF AS tbl_PropostaItem_ippUFFaturaNF,
	pri.ippFatorEqualizICMS AS tbl_PropostaItem_ippFatorEqualizICMS,
	pri.ippLanceMin AS tbl_PropostaItem_ippLanceMin,
	pri.ippLanceMinClassif AS tbl_PropostaItem_ippLanceMinClassif,
	pri.ippValorClassif AS tbl_PropostaItem_ippValorClassif,
	pri.ippIndAceito AS tbl_PropostaItem_ippIndAceito,
	pri.ippIndHabilitado AS tbl_PropostaItem_ippIndHabilitado,
	pri.ippIndAdjudicado AS tbl_PropostaItem_ippIndAdjudicado,
	pri.ippValNegAceit AS tbl_PropostaItem_ippValNegAceit,
	pri.ippValNegAdj AS tbl_PropostaItem_ippValNegAdj,
	pri.ippObsAceitacao AS tbl_PropostaItem_ippObsAceitacao,
	pri.ippObsAdjudicacao AS tbl_PropostaItem_ippObsAdjudicacao,
	pri.ippDataUltLance AS tbl_PropostaItem_ippDataUltLance,
	pri.ippFabricante AS tbl_PropostaItem_ippFabricante,
	pri.ippOrdemConvocacao AS tbl_PropostaItem_ippOrdemConvocacao,
	pri.ippDataIniConvocacao AS tbl_PropostaItem_ippDataIniConvocacao,
	pri.ippDataFimConvocacao AS tbl_PropostaItem_ippDataFimConvocacao,
	pri.ippStatusConvocacao AS tbl_PropostaItem_ippStatusConvocacao,
	pri.ippIndPropOriginal AS tbl_PropostaItem_ippIndPropOriginal,
	pri.ippIndCadSubcontratada AS tbl_PropostaItem_ippIndCadSubcontratada,
	pri.ippJustificativaSubPreg AS tbl_PropostaItem_ippJustificativaSubPreg,
	pri.ippJustificativaSubFornec AS tbl_PropostaItem_ippJustificativaSubFornec,
	pri.ippIndAnexo AS tbl_PropostaItem_ippIndAnexo,
	pri.ippOrdemConvocacao7174 AS tbl_PropostaItem_ippOrdemConvocacao7174,
	pri.ippDataIniConvocacao7174 AS tbl_PropostaItem_ippDataIniConvocacao7174,
	pri.ippDataFimConvocacao7174 AS tbl_PropostaItem_ippDataFimConvocacao7174,
	pri.ippStatusConvocacao7174 AS tbl_PropostaItem_ippStatusConvocacao7174,
	pri.ippMens5Min7174 AS tbl_PropostaItem_ippMens5Min7174,
	pri.ippIndTP AS tbl_PropostaItem_ippIndTP,
	pri.ippIndPPB AS tbl_PropostaItem_ippIndPPB,
	pri.contadorDePunicoes AS tbl_PropostaItem_contadorDePunicoes,
	pri.ippDeclaracaoProdNacional AS tbl_PropostaItem_ippDeclaracaoProdNacional,
	pri.ippCodPaisOrigem AS tbl_PropostaItem_ippCodPaisOrigem,
	pri.ippIndPossuiPessoasEmComum AS tbl_PropostaItem_ippIndPossuiPessoasEmComum,
	pri.ippCadReservaStatus AS tbl_PropostaItem_ippCadReservaStatus,
	pri.ippCadReservaDataAceite AS tbl_PropostaItem_ippCadReservaDataAceite,
	pri.ippModeloVersao AS tbl_PropostaItem_ippModeloVersao,
	pri.dataInclusao AS tbl_PropostaItem_dataInclusao,
	pri.dataAlteracao AS tbl_PropostaItem_dataAlteracao,
	pri.convocadoNaDisputaFechada AS tbl_PropostaItem_convocadoNaDisputaFechada,
	pri.ippLanceMinFaseFechada AS tbl_PropostaItem_ippLanceMinFaseFechada,
	pri.ippLanceMinClassifFaseFechada AS tbl_PropostaItem_ippLanceMinClassifFaseFechada,
	pri.ippDataUltLanceFaseFechada AS tbl_PropostaItem_ippDataUltLanceFaseFechada,
	pri.dataFimConvocacaoDisputaFechada AS tbl_PropostaItem_dataFimConvocacaoDisputaFechada,
	pri.ordemSorteioEletronico AS tbl_PropostaItem_ordemSorteioEletronico,
	pri.versaoSalaDisputa AS tbl_PropostaItem_versaoSalaDisputa,
	pr.prpCod AS tbl_Proposta_prpCod,
	pr.prgCod AS tbl_Proposta_prgCod,
	pr.Cliente_ID AS tbl_Proposta_Cliente_ID,
	pr.prpData AS tbl_Proposta_prpData,
	pr.prpCNPJ AS tbl_Proposta_prpCNPJ,
	pr.prpRazaoSocial AS tbl_Proposta_prpRazaoSocial,
--	pr.prpNomeAnexo AS tbl_Proposta_prpNomeAnexo, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
--	pr.prpNomeAnexoRetif AS tbl_Proposta_prpNomeAnexoRetif, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
--	pr.prpCaminhoAnexoRetif AS tbl_Proposta_prpCaminhoAnexoRetif, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
	pr.prpDataRetif AS tbl_Proposta_prpDataRetif,
	pr.prpPorteEmpresa AS tbl_Proposta_prpPorteEmpresa,
	pr.prpIndParticiparConvocacao AS tbl_Proposta_prpIndParticiparConvocacao,
	pr.prpDataParticiparConvocacao AS tbl_Proposta_prpDataParticiparConvocacao,
	pr.prpDeclaracaoInfantil AS tbl_Proposta_prpDeclaracaoInfantil,
	pr.prpDeclaracaoSuperveniente AS tbl_Proposta_prpDeclaracaoSuperveniente,
	pr.prpDataDeclaracao AS tbl_Proposta_prpDataDeclaracao,
	pr.prpIndConvocarDeclaracao AS tbl_Proposta_prpIndConvocarDeclaracao,
	pr.prpDeclaracaoPropIndependente AS tbl_Proposta_prpDeclaracaoPropIndependente,
	pr.prpDecTrabForcado AS tbl_Proposta_prpDecTrabForcado,
	pr.prpUnico AS tbl_Proposta_prpUnico,
	pr.dataInclusao AS tbl_Proposta_dataInclusao,
	pr.dataAlteracao AS tbl_Proposta_dataAlteracao,
	pr.prpDecAcessibilidade AS tbl_Proposta_prpDecAcessibilidade,
	pr.prpDeclaracaoCotaAprendizagem AS tbl_Proposta_prpDeclaracaoCotaAprendizagem,
--	pr.cliente_id_original AS tbl_Proposta_cliente_id_original, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
	pi.ipgCod AS tbl_pregaoitem_ipgCod,
	pi.prgCod AS tbl_pregaoitem_prgCod,
	pi.ipgItem AS tbl_pregaoitem_ipgItem,
	pi.ipgDescricao AS tbl_pregaoitem_ipgDescricao,
	pi.codmat AS tbl_pregaoitem_codmat,
	pi.ipgIdentMat AS tbl_pregaoitem_ipgIdentMat,
	pi.codmun AS tbl_pregaoitem_codmun,
	pi.coduf AS tbl_pregaoitem_coduf,
	pi.ipgQuantidade AS tbl_pregaoitem_ipgQuantidade,
	pi.ipgUnidForn AS tbl_pregaoitem_ipgUnidForn,
	pi.spgCod AS tbl_pregaoitem_spgCod,
	pi.ipgValorRef AS tbl_pregaoitem_ipgValorRef,
	pi.ipgValorMin AS tbl_pregaoitem_ipgValorMin,
	pi.ipgClienteLanceMin AS tbl_pregaoitem_ipgClienteLanceMin,
	pi.ipgCliente_id AS tbl_pregaoitem_ipgCliente_id,
	pi.ipgDataIminenciaEncerramento AS tbl_pregaoitem_ipgDataIminenciaEncerramento,
	pi.ipgDataEncerramentoReal AS tbl_pregaoitem_ipgDataEncerramentoReal,
--	pi.ipgJustRecurso AS tbl_pregaoitem_ipgJustRecurso, -- SQL Error: Tipo CLOB
	pi.ipgDataDecisao AS tbl_pregaoitem_ipgDataDecisao,
	pi.ipgCPFDecisao AS tbl_pregaoitem_ipgCPFDecisao,
	pi.ipgDecisaoRecurso AS tbl_pregaoitem_ipgDecisaoRecurso,
	pi.ipgDataDecisaoAut AS tbl_pregaoitem_ipgDataDecisaoAut,
	pi.ipgCPFDecisaoAut AS tbl_pregaoitem_ipgCPFDecisaoAut,
	pi.ipgDecisaoRecursoAut AS tbl_pregaoitem_ipgDecisaoRecursoAut,
--	pi.ipgJustRecursoAut AS tbl_pregaoitem_ipgJustRecursoAut, -- SQL Error: Tipo CLOB
	pi.ipgDecisaoHomologacao AS tbl_pregaoitem_ipgDecisaoHomologacao,
	pi.ipgSeqSessao AS tbl_pregaoitem_ipgSeqSessao,
	pi.ipgNomeItem AS tbl_pregaoitem_ipgNomeItem,
	pi.ipgDataSuspensao AS tbl_pregaoitem_ipgDataSuspensao,
	pi.ipgFormaJulg AS tbl_pregaoitem_ipgFormaJulg,
	pi.ipgValorMinClassif AS tbl_pregaoitem_ipgValorMinClassif,
	pi.ipgMotivoCancAceitAdj AS tbl_pregaoitem_ipgMotivoCancAceitAdj,
	pi.ipgGrupo AS tbl_pregaoitem_ipgGrupo,
	pi.ipgCodGrupo AS tbl_pregaoitem_ipgCodGrupo,
	pi.ipgTipoBeneficio AS tbl_pregaoitem_ipgTipoBeneficio,
	pi.ipgCodItemPrincipal AS tbl_pregaoitem_ipgCodItemPrincipal,
	pi.ipgIndItemPrincipal AS tbl_pregaoitem_ipgIndItemPrincipal,
	pi.ipgDataLimiteRecurso AS tbl_pregaoitem_ipgDataLimiteRecurso,
	pi.ipgDataLimiteContraRazao AS tbl_pregaoitem_ipgDataLimiteContraRazao,
	pi.ipgDataLimiteDecisao AS tbl_pregaoitem_ipgDataLimiteDecisao,
	pi.ipgPercSubcontratacaoMin AS tbl_pregaoitem_ipgPercSubcontratacaoMin,
	pi.ipgPercSubcontratacaoMax AS tbl_pregaoitem_ipgPercSubcontratacaoMax,
	p.prgCod AS tbl_Pregao_prgCod,
	p.coduasg AS tbl_Pregao_coduasg,
	p.numprp AS tbl_Pregao_numprp,
	p.prgObjeto AS tbl_Pregao_prgObjeto,
	p.prgDescricao AS tbl_Pregao_prgDescricao,
	p.prgDataAbertura AS tbl_Pregao_prgDataAbertura,
	p.prgDataInclusao AS tbl_Pregao_prgDataInclusao,
	p.prgPregoeiroCad AS tbl_Pregao_prgPregoeiroCad,
	p.prgPregoeiroExec AS tbl_Pregao_prgPregoeiroExec,
	p.prgBat AS tbl_Pregao_prgBat,
	p.prgTimeBat AS tbl_Pregao_prgTimeBat,
	p.prgTempoLimite AS tbl_Pregao_prgTempoLimite,
	p.prgStatus AS tbl_Pregao_prgStatus,
	p.prgDataAberturaReal AS tbl_Pregao_prgDataAberturaReal,
	p.prgDataHom AS tbl_Pregao_prgDataHom,
	p.prgCPFHom AS tbl_Pregao_prgCPFHom,
	p.prgNomePregoeiro AS tbl_Pregao_prgNomePregoeiro,
	p.prgMembro1 AS tbl_Pregao_prgMembro1,
	p.prgMembro2 AS tbl_Pregao_prgMembro2,
	p.prgMembro3 AS tbl_Pregao_prgMembro3,
	p.prgPortaria AS tbl_Pregao_prgPortaria,
	p.prgDataPortaria AS tbl_Pregao_prgDataPortaria,
	p.prgProcesso AS tbl_Pregao_prgProcesso,
	p.codPregoeiro AS tbl_Pregao_codPregoeiro,
	p.codMembro1 AS tbl_Pregao_codMembro1,
	p.codMembro2 AS tbl_Pregao_codMembro2,
	p.codMembro3 AS tbl_Pregao_codMembro3,
	p.prgDataEntregaProp AS tbl_Pregao_prgDataEntregaProp,
	p.prgDataEncerramento AS tbl_Pregao_prgDataEncerramento,
	p.prgDataAbreIntencaoRecurso AS tbl_Pregao_prgDataAbreIntencaoRecurso,
	p.prgDataFechaIntencaoRecurso AS tbl_Pregao_prgDataFechaIntencaoRecurso,
	p.prgIndSRP AS tbl_Pregao_prgIndSRP,
	p.prgDataJulg AS tbl_Pregao_prgDataJulg,
	p.prgCPFJulg AS tbl_Pregao_prgCPFJulg,
	p.prgNomeHom AS tbl_Pregao_prgNomeHom,
	p.prgClienteIDChat AS tbl_Pregao_prgClienteIDChat,
	p.prgDataLimiteRecurso AS tbl_Pregao_prgDataLimiteRecurso,
	p.prgDataLimiteContraRazao AS tbl_Pregao_prgDataLimiteContraRazao,
	p.prgDataAdjudic AS tbl_Pregao_prgDataAdjudic,
	p.prgCPFAdjudic AS tbl_Pregao_prgCPFAdjudic,
	p.prgDataLimiteDecisao AS tbl_Pregao_prgDataLimiteDecisao,
	p.prgNomeJulg AS tbl_Pregao_prgNomeJulg,
	p.prgNomeAdjudic AS tbl_Pregao_prgNomeAdjudic,
	p.prgDataUltimaVoltaFase AS tbl_Pregao_prgDataUltimaVoltaFase,
	p.prgFaseUltimaVoltaFase AS tbl_Pregao_prgFaseUltimaVoltaFase,
	p.prgDataReaberturaSessao AS tbl_Pregao_prgDataReaberturaSessao,
	p.prgMotivoUltimaVoltaFase AS tbl_Pregao_prgMotivoUltimaVoltaFase,
	p.prgRecursoInter AS tbl_Pregao_prgRecursoInter,
	p.prgOrigemRecurso AS tbl_Pregao_prgOrigemRecurso,
	p.prgPercentualLance AS tbl_Pregao_prgPercentualLance,
	p.prgCodEvento AS tbl_Pregao_prgCodEvento,
	p.prgIndElet AS tbl_Pregao_prgIndElet,
	p.prgIndICMS AS tbl_Pregao_prgIndICMS,
	p.prgCodTipoSuspensao AS tbl_Pregao_prgCodTipoSuspensao,
	p.prgCodAvisoEvento AS tbl_Pregao_prgCodAvisoEvento,
	p.prgDataPublicacaoEvento AS tbl_Pregao_prgDataPublicacaoEvento,
	p.prgCodEventoAnterior AS tbl_Pregao_prgCodEventoAnterior,
	p.tempoMinimoLance AS tbl_Pregao_tempoMinimoLance,
	p.numOcorrenciasLance AS tbl_Pregao_numOcorrenciasLance,
	p.prgDataConsultaPessoasEmComum AS tbl_Pregao_prgDataConsultaPessoasEmComum,
	p.dataInclusao AS tbl_Pregao_dataInclusao,
	p.dataAlteracao AS tbl_Pregao_dataAlteracao,
	p.prgModoDisputa AS tbl_Pregao_prgModoDisputa,
	p.retornoServicoRestAbrirSessaoPublica AS tbl_Pregao_retornoServicoRestAbrirSessaoPublica,
	p.faseSalaDisputa AS tbl_Pregao_faseSalaDisputa,
	p.prgSeqSessao AS tbl_Pregao_prgSeqSessao,
	p.prgIndEmergencial AS tbl_Pregao_prgIndEmergencial,
	u.coduasg AS tb_uasg_coduasg,
	u.nomuasg AS tb_uasg_nomuasg,
	u.titulo01 AS tb_uasg_titulo01,
	u.titulo02 AS tb_uasg_titulo02,
	u.titulo03 AS tb_uasg_titulo03,
	u.titulo04 AS tb_uasg_titulo04,
	u.titulo05 AS tb_uasg_titulo05,
	u.titulo06 AS tb_uasg_titulo06,
	u.titulo07 AS tb_uasg_titulo07,
	u.titulo08 AS tb_uasg_titulo08,
	u.titulo09 AS tb_uasg_titulo09,
	u.titulo10 AS tb_uasg_titulo10,
	u.titulo11 AS tb_uasg_titulo11,
	u.titulo12 AS tb_uasg_titulo12,
	u.uf AS tb_uasg_uf,
	u.CodOrgao AS tb_uasg_CodOrgao,
	u.CodSiorg AS tb_uasg_CodSiorg,
	u.SiglaUasg AS tb_uasg_SiglaUasg,
	u.NomeOrgao AS tb_uasg_NomeOrgao,
	u.CodMunic AS tb_uasg_CodMunic,
	u.Endereco AS tb_uasg_Endereco,
	u.Cep AS tb_uasg_Cep,
	u.DDD AS tb_uasg_DDD,
	u.Telefone1 AS tb_uasg_Telefone1,
	u.Ramal1 AS tb_uasg_Ramal1,
	u.Telefone2 AS tb_uasg_Telefone2,
	u.Ramal2 AS tb_uasg_Ramal2,
	u.Fax AS tb_uasg_Fax,
	u.IndicadorFornec AS tb_uasg_IndicadorFornec,
	u.nomeBrasao AS tb_uasg_nomeBrasao,
	u.bloqueioCertificado AS tb_uasg_bloqueioCertificado,
	u.coduasgPolo AS tb_uasg_coduasgPolo,
--	u.Situacao AS tb_uasg_Situacao, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
--	u.indSISG AS tb_uasg_indSISG, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
--	u.adesaoSIASG AS tb_uasg_adesaoSIASG, -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
	o.CodOrgao AS tb_orgao_CodOrgao,
	o.NomeOrgao AS tb_orgao_NomeOrgao,
	o.Logo AS tb_orgao_Logo,
	o.TipoAdm AS tb_orgao_TipoAdm,
	o.Esfera AS tb_orgao_Esfera,
	o.Poder AS tb_orgao_Poder,
	o.CodOrgaoVinculado AS tb_orgao_CodOrgaoVinculado
--	o.cnpj AS tb_orgao_cnpj -- Presente no Comprasnet_VBL (DaaS), mas faltando no Datalake Produção
FROM Stg_Comprasnet.dbo.tbl_Lances_Encerrados l
	JOIN Stg_Comprasnet.dbo.tbl_pregaoitem pi ON pi.ipgCod = l.ipgCod
	JOIN Stg_Comprasnet.dbo.tbl_Pregao p ON p.prgCod = pi.prgCod
	JOIN Stg_Comprasnet.dbo.tbl_PropostaItem pri ON pri.ipgCod = l.ipgCod
	JOIN Stg_Comprasnet.dbo.tbl_Proposta pr ON (pr.prpCod = pri.prpCod AND pr.Cliente_ID = l.cliente_id)
	JOIN Stg_Comprasnet.dbo.tb_uasg u ON p.coduasg = u.coduasg
	JOIN Stg_Comprasnet.dbo.tb_orgao o ON o.CodOrgao = u.CodOrgao
	LEFT JOIN Stg_Comprasnet.dbo.tb_orgao o2 ON o2.CodOrgao= o.CodOrgaoVinculado
WHERE 1=1
	AND l.lanData BETWEEN '2010-01-01 00:00:00' AND '2018-10-17 09:26:32'
	AND (o2.CodOrgao IN (95430) OR p.coduasg IN (986001))
;