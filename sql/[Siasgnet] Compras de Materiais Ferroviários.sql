SELECT
     LPAD(c.numerouasgresponsavel,6,'0')||LPAD(c.codigomodalidadecompra,2,'0')||LPAD(c.numerocompra,5,'0')||LPAD(c.anocompra,4,'0') AS codcompra
    ,CASE WHEN u.sisg = 'T' THEN 'SISG' WHEN u.sisg = 'F' THEN 'Não SISG' END AS sisg
    ,UPPER(o.nome) AS orgao
    ,UPPER(u.nome) AS uasg
    ,UPPER(m.uf) AS uf
    ,CASE WHEN m.nome = 'BRASÍLIA' THEN 'Brasília' ELSE m.nome END AS municipio
    ,mc.descricao AS modalidade
    ,CASE WHEN vcl.codigoformarealizacao = 2 THEN 'Presencial' ELSE 'Eletrônico' END AS formato
    ,CASE WHEN vcl.codigocaracteristicalicitacao = 2 THEN 'Registro de Preços' ELSE 'Tradicional' END AS srp
    ,UPPER(c.numerouasgresponsavel) coduasg
    ,CAST(c.numerocompra AS INTEGER) AS numcumpra
    ,CAST(c.anocompra AS INTEGER) AS anocompra
    ,UPPER(vc.objeto) AS objeto
    ,l.descricaocurta||' - '||l.nomelei AS leinome
    ,'http://compras.dados.gov.br/licitacoes/doc/licitacao/'||LPAD(c.numerouasgresponsavel,6,'0')||LPAD(c.codigomodalidadecompra,2,'0')||LPAD(c.numerocompra,5,'0')||LPAD(c.anocompra,4,'0') AS link
	,ic.numeroitem
    ,CASE ic.codigotipoitem WHEN 0 THEN 'Material' WHEN 1 THEN 'Serviço' ELSE ic.codigotipoitem END tipoitem
    ,ic.quantidade
    ,ic.unidadefornecimento
    ,ic.codigoitemcatalogo
    ,ic.descricao
    ,pp.valortotal
--    ,ic.descricaodetalhada
FROM Siasgnet_dc_VBL.compra c
	JOIN Siasgnet_dc_VBL.versaocompra vc ON vc.codigocompra = c.codigocompra
	JOIN Siasgnet_dc_VBL.versaocompracomlicitacao vcl ON vc.codigoversaocompra = vcl.codigoversaocompracomlicitacao
	JOIN Siasgnet_dc_VBL.versaocompraitemcompra vcic ON vcic.codigoversaocompra = vc.codigoversaocompra
	JOIN Siasgnet_dc_VBL.itemcompra ic ON ic.codigoitemcompra = vcic.codigoitemcompra
	JOIN Siasgnet_dc_VBL.pesquisaprecomercado pp ON pp.codigoitemcompra = vcic.codigoitemcompra 
--	JOIN Siasgnet_dc_VBL.itemlicitacao il ON il.codigoitemlicitacao = vcic.codigoitemcompra
	JOIN Siasgnet_VBL.uasg u ON u.numerouasg = c.numerouasgresponsavel
	JOIN Siasgnet_VBL.orgao o ON o.numeroorgao = u.numeroorgaouasg
	JOIN Siasgnet_VBL.municipio m ON m.codigomunicipio = u.codigomunicipio
	JOIN Siasgnet_VBL.lei l ON l.codigolei = c.codigolei
	JOIN Siasgnet_VBL.modalidadecompra mc ON mc.codigomodalidadecompra = c.codigomodalidadecompra
WHERE 1=1
	AND u.sisg = 'T'
    AND SUBSTRING(vcl.datahoraregistro,1,10) BETWEEN '2022-00-00' AND '2024-00-00'
    AND mc.tipomodalidadecompra = 'C'
    AND ic.codigotipoitem = 0
    AND ic.codigoitemcatalogo IN (1686,1791,1805,2011,2402,2410,2453,2488,2496,2631,4227,4235,4243,4251,4260,4278,4286,4294,4308,4316,4324,4332,4340,4359,4367,4375,4383,4391,4405,4413,4421,4430,4456,4464,4472,4480,4499,4502,4529,4537,4553,4561,4570,4600,4618,4626,4634,4642,4650,4669,4677,4685,4693,4707,4715,4731,4740,4758,4766,4774,4782,4790,4804,4812,4820,4839,4847,4855,10693,10863,11703,18740,22560,22578,28193,31194,31208,31224,31232,31240,33537,34762,34916,34967,35980,36005,36013,36021,36030,36048,36056,36064,36072,36080,36099,36102,36110,36129,36137,36145,36153,36170,36188,36196,36200,36218,36226,36234,36242,36250,36269,36277,36293,36307,36315,36323,36331,36340,36358,36366,36374,36382,36390,36404,36412,36420,36439,36447,36455,36463,36471,36480,36498,36501,36510,36528,36536,36773,36781,37168,37176,37184,37192,37206,37214,37222,37230,37249,37257,37265,37273,37281,37290,37303,37311,37320,37338,37346,37354,37362,37370,37389,37397,37400,39659,39721,42404,42412,45837,45845,45861,45888,47074,47082,48305,48313,48321,48330,48348,48356,48364,48372,48380,48399,48402,48410,48429,48437,48445,48453,48461,48470,48488,48496,52418,52426,52434,52442,52450,52469,52477,52485,52493,52507,52515,52523,52531,52540,52558,52566,52574,52582,52590,52604,52612,54372,58718,59137,60011,60283,60380,60402,61859,61867,61875,62235,65960,66206,67881,68365,69647,70009,72842,73768,74969,75248,75329,75701,75710,76449,81744,81752,81760,81779,81787,81795,81809,81817,81825,81833,81841,81850,81868,81876,81884,81892,81906,81914,81922,81930,81949,81957,81965,81973,81981,81990,82007,82015,82023,82031,83755,85456,90972,93165,94633,100404,103730,103748,104493,104507,106879,107069,108200,112496,121274,130125,130419,130427,132314,132357,135828,135836,150023,150064,150065,150873,150972,151035,191740,192210,192220,192230,192240,192250,192410,192420,192430,193805,193810,193815,193820,193825,193830,193835,193895,196330,221155,225034,225035,225038,225039,225040,225041,225330,225331,225332,225333,225334,225335,225336,225337,225348,225462,225463,225464,225465,225466,225467,225468,225469,225470,225471,225472,225473,225474,225475,225476,225485,225486,225487,225488,225493,225494,225495,225537,233370,233371,233934,234652,234653,234680,234681,234682,239954,246085,246614,252996,252997,252998,252999,253000,253001,253002,253003,254614,256669,257159,259749,263862,265212,265587,266059,266063,266336,266337,268631,268637,268639,271756,272925,273227,273228,274170,274879,274880,279538,282926,285952,286690,286698,287181,287792,287793,287794,287796,287797,287798,287799,287806,287807,287808,287809,287810,287811,288469,288470,291119,293021,293022,293560,293561,297567,300637,302127,302253,302905,303796,303850,304347,305056,305057,305059,305199,305254,305256,308465,312240,312243,312244,312245,318471,318711,318712,318713,319457,319458,319461,319656,319789,319790,321652,322040,322045,324217,324249,325017,325020,326585,327000,327137,327780,333800,334947,336272,336274,337378,337475,337523,337942,338003,338084,338161,339512,339989,341027,341034,341956,342206,342207,343524,347028,355065,355067,355070,355344,355345,358238,359082,359773,359774,362195,362197,362202,362204,362206,362210,365332,369583,375418,376326,376327,376328,376329,376330,376345,384735,384738,398015,398016,398017,398106,403420)
UNION
SELECT
     LPAD(c.numerouasgresponsavel,6,'0')||LPAD(c.codigomodalidadecompra,2,'0')||LPAD(c.numerocompra,5,'0')||LPAD(c.anocompra,4,'0') AS codcompra
    ,CASE WHEN u.sisg = 'T' THEN 'SISG' WHEN u.sisg = 'F' THEN 'Não SISG' END AS sisg
    ,UPPER(o.nome) AS orgao
    ,UPPER(u.nome) AS uasg
    ,UPPER(m.uf) AS uf
    ,CASE WHEN m.nome = 'BRASÍLIA' THEN 'Brasília' ELSE m.nome END AS municipio
    ,mc.descricao AS modalidade
    ,CASE WHEN c.codigopedidodispensaeletronica IS NOT NULL THEN 'Cotação Eletrônica' ELSE 'Tradicional' END AS formato
    ,CASE WHEN vsl.codigocaracteristicalicitacao = 2 THEN 'Registro de Preços' ELSE 'Tradicional' END AS srp
    ,UPPER(c.numerouasgresponsavel) AS coduasg
    ,CAST(c.numerocompra AS INTEGER) AS numcompra
    ,CAST(c.anocompra AS INTEGER) AS anocompra
    ,UPPER(vc.objeto) AS objeto
    ,l.descricaocurta||' - '||l.nomelei AS leinome
    ,'http://compras.dados.gov.br/compraSemLicitacao/doc/compra_slicitacao/'||LPAD(c.numerouasgresponsavel,6,'0')||LPAD(c.codigomodalidadecompra,2,'0')||LPAD(c.numerocompra,5,'0')||LPAD(c.anocompra,4,'0') AS link
    ,ic.numeroitem
    ,CASE ic.codigotipoitem WHEN 0 THEN 'Material' WHEN 1 THEN 'Serviço' ELSE ic.codigotipoitem END tipoitem
    ,ic.quantidade
    ,ic.unidadefornecimento
    ,ic.codigoitemcatalogo
    ,ic.descricao
--    ,ic.descricaodetalhada
	,pp.valortotal
FROM Siasgnet_dc_VBL.compra c
	JOIN Siasgnet_dc_VBL.versaocompra vc ON vc.codigocompra = c.codigocompra
	JOIN Siasgnet_dc_VBL.versaocomprasemlicitacao vsl ON vc.codigoversaocompra = vsl.codigoversaocomprasemlicitacao
	JOIN Siasgnet_dc_VBL.versaocompraitemcompra vcic ON vcic.codigoversaocompra = vc.codigoversaocompra
	JOIN Siasgnet_dc_VBL.itemcompra ic ON ic.codigoitemcompra = vcic.codigoitemcompra
	JOIN Siasgnet_dc_VBL.pesquisaprecomercado pp ON pp.codigoitemcompra = vcic.codigoitemcompra 
--	LEFT JOIN Siasgnet_dc_VBL.itemdispensa id ON id.codigoitemdispensa = vcic.codigoitemcompra
--	LEFT JOIN Siasgnet_dc_VBL.itemdispensaeletronica ide ON ide.codigoitemdispensaeletronica = vcic.codigoitemcompra
--	LEFT JOIN Siasgnet_dc_VBL.iteminexigibilidade ii ON ii.codigoiteminexigibilidade = vcic.codigoitemcompra
--	LEFT JOIN Siasgnet_dc_VBL.itemoutrashipoteses ioh ON ioh.codigoitemoutrashipoteses = vcic.codigoitemcompra
	JOIN Siasgnet_VBL.uasg u ON u.numerouasg = c.numerouasgresponsavel
	JOIN Siasgnet_VBL.orgao o ON o.numeroorgao = u.numeroorgaouasg
	JOIN Siasgnet_VBL.municipio m ON m.codigomunicipio = u.codigomunicipio
	JOIN Siasgnet_VBL.lei l ON l.codigolei = c.codigolei
	JOIN Siasgnet_VBL.modalidadecompra mc ON mc.codigomodalidadecompra = c.codigomodalidadecompra
WHERE 1=1
	AND u.sisg = 'T'
    AND SUBSTRING(vsl.datahoraregistro,1,10) BETWEEN '2022-00-00' AND '2024-00-00'
    AND mc.tipomodalidadecompra = 'S'
    AND ic.codigotipoitem = 0
    AND ic.codigoitemcatalogo IN (1686,1791,1805,2011,2402,2410,2453,2488,2496,2631,4227,4235,4243,4251,4260,4278,4286,4294,4308,4316,4324,4332,4340,4359,4367,4375,4383,4391,4405,4413,4421,4430,4456,4464,4472,4480,4499,4502,4529,4537,4553,4561,4570,4600,4618,4626,4634,4642,4650,4669,4677,4685,4693,4707,4715,4731,4740,4758,4766,4774,4782,4790,4804,4812,4820,4839,4847,4855,10693,10863,11703,18740,22560,22578,28193,31194,31208,31224,31232,31240,33537,34762,34916,34967,35980,36005,36013,36021,36030,36048,36056,36064,36072,36080,36099,36102,36110,36129,36137,36145,36153,36170,36188,36196,36200,36218,36226,36234,36242,36250,36269,36277,36293,36307,36315,36323,36331,36340,36358,36366,36374,36382,36390,36404,36412,36420,36439,36447,36455,36463,36471,36480,36498,36501,36510,36528,36536,36773,36781,37168,37176,37184,37192,37206,37214,37222,37230,37249,37257,37265,37273,37281,37290,37303,37311,37320,37338,37346,37354,37362,37370,37389,37397,37400,39659,39721,42404,42412,45837,45845,45861,45888,47074,47082,48305,48313,48321,48330,48348,48356,48364,48372,48380,48399,48402,48410,48429,48437,48445,48453,48461,48470,48488,48496,52418,52426,52434,52442,52450,52469,52477,52485,52493,52507,52515,52523,52531,52540,52558,52566,52574,52582,52590,52604,52612,54372,58718,59137,60011,60283,60380,60402,61859,61867,61875,62235,65960,66206,67881,68365,69647,70009,72842,73768,74969,75248,75329,75701,75710,76449,81744,81752,81760,81779,81787,81795,81809,81817,81825,81833,81841,81850,81868,81876,81884,81892,81906,81914,81922,81930,81949,81957,81965,81973,81981,81990,82007,82015,82023,82031,83755,85456,90972,93165,94633,100404,103730,103748,104493,104507,106879,107069,108200,112496,121274,130125,130419,130427,132314,132357,135828,135836,150023,150064,150065,150873,150972,151035,191740,192210,192220,192230,192240,192250,192410,192420,192430,193805,193810,193815,193820,193825,193830,193835,193895,196330,221155,225034,225035,225038,225039,225040,225041,225330,225331,225332,225333,225334,225335,225336,225337,225348,225462,225463,225464,225465,225466,225467,225468,225469,225470,225471,225472,225473,225474,225475,225476,225485,225486,225487,225488,225493,225494,225495,225537,233370,233371,233934,234652,234653,234680,234681,234682,239954,246085,246614,252996,252997,252998,252999,253000,253001,253002,253003,254614,256669,257159,259749,263862,265212,265587,266059,266063,266336,266337,268631,268637,268639,271756,272925,273227,273228,274170,274879,274880,279538,282926,285952,286690,286698,287181,287792,287793,287794,287796,287797,287798,287799,287806,287807,287808,287809,287810,287811,288469,288470,291119,293021,293022,293560,293561,297567,300637,302127,302253,302905,303796,303850,304347,305056,305057,305059,305199,305254,305256,308465,312240,312243,312244,312245,318471,318711,318712,318713,319457,319458,319461,319656,319789,319790,321652,322040,322045,324217,324249,325017,325020,326585,327000,327137,327780,333800,334947,336272,336274,337378,337475,337523,337942,338003,338084,338161,339512,339989,341027,341034,341956,342206,342207,343524,347028,355065,355067,355070,355344,355345,358238,359082,359773,359774,362195,362197,362202,362204,362206,362210,365332,369583,375418,376326,376327,376328,376329,376330,376345,384735,384738,398015,398016,398017,398106,403420)
;